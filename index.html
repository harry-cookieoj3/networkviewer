    <script>
        const FILE_ID = '1Be7JMrTnqoarJ9R1Bdv3cZttJ0WPa73cisuYTERuYNY';
        
        // --- ここを書き換えるだけで見た目を調整できます ---
        const SCALE = 1000;       // 座標の倍率（さらに広げました）
        const NODE_SIZE = 80;     // ノード（点）の大きさ
        const FONT_SIZE = 60;     // ラベル（文字）の大きさ
        const EDGE_WIDTH = 10;    // 線の太さ
        // ----------------------------------------------

        function log(msg, type = '') {
            const panel = document.getElementById('log-panel');
            const div = document.createElement('div');
            div.className = 'log-entry ' + type;
            div.innerText = `[${new Date().toLocaleTimeString()}] ${msg}`;
            panel.appendChild(div);
            panel.scrollTop = panel.scrollHeight;
        }

        async function fetchData(url, name) {
            const response = await fetch(url);
            const text = await response.text();
            return Papa.parse(text, { header: true, skipEmptyLines: true, transformHeader: h => h.trim().toLowerCase() }).data;
        }

        async function init() {
            const nodeUrl = `https://docs.google.com/spreadsheets/d/${FILE_ID}/gviz/tq?tqx=out:csv&gid=0`;
            const edgeUrl = `https://docs.google.com/spreadsheets/d/${FILE_ID}/gviz/tq?tqx=out:csv&gid=1184231939`;

            try {
                const [nodesData, edgesData] = await Promise.all([
                    fetchData(nodeUrl, "ノード"),
                    fetchData(edgeUrl, "エッジ")
                ]);

                const elements = [];
                const nodeIdSet = new Set();

                nodesData.forEach(row => {
                    const id = String(row.id || row.Id || "").trim();
                    if (id) {
                        elements.push({
                            group: 'nodes',
                            data: { 
                                id: id, 
                                label: row.label || id,
                                nodeColor: row.color || row.Color || '#1a73e8',
                                rawData: row 
                            },
                            position: { 
                                x: parseFloat(row.x || 0) * SCALE, 
                                y: parseFloat(row.y || 0) * SCALE 
                            }
                        });
                        nodeIdSet.add(id);
                    }
                });

                edgesData.forEach(row => {
                    const s = String(row.source || "").trim();
                    const t = String(row.target || "").trim();
                    if (nodeIdSet.has(s) && nodeIdSet.has(t)) {
                        elements.push({
                            group: 'edges',
                            data: { source: s, target: t }
                        });
                    }
                });

                const cy = cytoscape({
                    container: document.getElementById('cy'),
                    elements: elements,
                    style: [
                        { 
                            selector: 'node', 
                            style: { 
                                'label': 'data(label)', 
                                'background-color': 'data(nodeColor)', 
                                'width': NODE_SIZE, 
                                'height': NODE_SIZE, 
                                'font-size': FONT_SIZE,
                                'text-valign': 'bottom',
                                'text-margin-y': 10,
                                'color': '#000',
                                'font-weight': 'bold',
                                'text-outline-width': 2,
                                'text-outline-color': '#fff'
                            } 
                        },
                        { 
                            selector: 'edge', 
                            style: { 
                                'width': EDGE_WIDTH, 
                                'line-color': '#ccc', 
                                'opacity': 0.4, 
                                'curve-style': 'haystack' 
                            } 
                        }
                    ],
                    layout: { name: 'preset' },
                    autoungrabify: true
                });

                cy.on('mouseover tap', 'node', function(evt){
                    const data = evt.target.data('rawData');
                    let info = "【詳細】";
                    for(let key in data) { info += ` ${key}: ${data[key]} |`; }
                    log(info, 'log-info');
                });

                log(`調整完了。倍率:${SCALE}, 点:${NODE_SIZE}, 文字:${FONT_SIZE}`);

            } catch (e) {
                log("エラー: " + e.message, 'log-error');
            }
        }
        init();
    </script>
